<!DOCTYPE html>
<html>
  <head>
    <title>calorie calculater</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag "index_style", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
  </head>

  <body>
    <header>
      <div class = "header-logo">
        calorie calculater
      </div>
    </header>

    <div class = "container">
      <div class = "top-contents">
        <h3>今日の目標カロリー(kcal):</h3>
        <!--
        <%= form_with url: users_path, method: :post do |form| %>
          <input type="text" name = "target">
          <input type="submit">
        <% end %>
        --> <!--form_with は createアクションに飛ぶ-->
        <form>
          <input type="text" id = "target">
          <button type="button" onclick="getvalue()">更新</button> <!-- type="submit"フォームの送信 type="button"フォームの送信をしない-->
        </form>

        <h3>今日の残り摂取カロリー(kcal):</h3>
        <p id = "remaining_output"></p>

        <script>
          document.getElementById('remaining_output').innerText = 'none.';

          function getvalue(){
            var target = document.getElementById('target').value;
            
            var remaining = target - '<%= @calorie_sum %>';

            if(target == null){
              document.getElementById('remaining_output').innerText = 'none.';
            }
            else{
              document.getElementById('remaining_output').innerText = remaining;
            }
          }
        </script>
      </div> <!--top_contents-->

      <div class = "main_contents">
        <%= link_to "新規登録", new_user_path %>

        <h3>今日の記録</h3>
        <% @record.each do |record| %>
          <%= record.dish %>
          <%= record.calorie %>
          <%= link_to "更新", edit_user_path(record) %>
          <%= link_to "詳細", user_path(record) %><br>
        <% end %>
      </div> <!--main_contents-->
    </div>
    
    <footer></footer>

  </body>
</html>
